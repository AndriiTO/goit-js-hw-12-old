{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '53390441-690cb9fa742523782d54564fc';\n\nconst DEFAULT_PARAMS = {\n  key: API_KEY,\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: 15,\n};\n\n\n\n\nexport async function getImagesByQuery(query, page = 1) {\n  try {\n    const params = {\n      ...DEFAULT_PARAMS,\n      q: query,\n      page,\n    };\n\n    const response = await axios.get(BASE_URL, { params });\n    return response.data;\n  } catch (error) {\n       throw error;\n  }\n}","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst galleryEl = document.getElementById('gallery');\nconst loaderEl = document.querySelector('.loader'); \nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\nconst loadMoreBtn = document.getElementById('load-more');\n\nexport function createGallery(images) {\n  if (!Array.isArray(images) || images.length === 0) return;\n\n  const markup = images\n    .map(\n      img => `\n    <li class=\"gallery__item\">\n      <a class=\"gallery-link\" href=\"${img.largeImageURL}\">\n        <img src=\"${img.webformatURL}\" alt=\"${img.tags}\" loading=\"lazy\" />\n        <div class=\"info\">\n          <p class=\"info-item\"><b>Likes:</b> ${img.likes}</p>\n          <p class=\"info-item\"><b>Views:</b> ${img.views}</p>\n          <p class=\"info-item\"><b>Comments:</b> ${img.comments}</p>\n          <p class=\"info-item\"><b>Downloads:</b> ${img.downloads}</p>\n        </div>\n      </a>\n    </li>`\n    )\n    .join('');\n\n   galleryEl.insertAdjacentHTML('beforeend', markup);\n\n   lightbox.refresh();\n}\n\nexport function clearGallery() {\n  if (!galleryEl) return;\n  galleryEl.innerHTML = '';\n  lightbox.refresh();\n}\n\nexport function showLoader() {\n  if (!loaderEl) return;\n  loaderEl.classList.remove('is-hidden');\n}\n\nexport function hideLoader() {\n  if (!loaderEl) return;\n  loaderEl.classList.add('is-hidden');\n}\n\nexport function showLoadMoreButton() {\n  if (!loadMoreBtn) return;\n  loadMoreBtn.classList.remove('is-hidden');\n}\n\nexport function hideLoadMoreButton() {\n  if (!loadMoreBtn) return;\n  loadMoreBtn.classList.add('is-hidden');\n}\n\nexport function getGalleryElement() {\n  return galleryEl;\n}","import './main.css';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport iziToast from 'izitoast';\n\nimport { getImagesByQuery } from './js/pixabay-api';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n  getGalleryElement,\n} from './js/render-functions';\n\nconst form = document.querySelector('.form');\nconst input = document.querySelector('input[name=\"search-text\"]');\nconst loadMoreBtn = document.getElementById('load-more');\n\nlet currentQuery = '';\nlet currentPage = 1;\nlet totalHits = 0;\nconst perPage = 15;\n\nform.addEventListener('submit', onSearch);\nloadMoreBtn.addEventListener('click', onLoadMore);\n\nasync function onSearch(e) {\n  e.preventDefault();\n\n  const query = input.value.trim();\n  if (!query) {\n    iziToast.warning({\n      title: 'Warning',\n      message: 'Please enter a search term.',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  currentQuery = query;\n  currentPage = 1;\n  totalHits = 0;\n\n  clearGallery();\n  hideLoadMoreButton();\n  showLoader();\n\n  try {\n    const data = await getImagesByQuery(currentQuery, currentPage);\n\n    if (!data || !data.hits.length) {\n      iziToast.info({\n        title: 'Info',\n        message: 'Sorry, there are no images matching your search query!',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    totalHits = data.totalHits;\n    createGallery(data.hits);\n\n    iziToast.success({\n      title: 'Success',\n      message: `Hooray! We found ${totalHits} images.`,\n      position: 'topRight',\n    });\n\n    // Якщо результати закінчуються вже на першій сторінці\n    if (totalHits <= perPage) {\n      hideLoadMoreButton();\n      iziToast.info({\n        title: 'End',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    } else {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong. Please try again later.',\n      position: 'topRight',\n    });\n  } finally {\n    hideLoader();\n  }\n}\n\nasync function onLoadMore() {\n  currentPage += 1;\n\n  hideLoadMoreButton();\n  showLoader();\n\n  try {\n    const data = await getImagesByQuery(currentQuery, currentPage);\n\n    createGallery(data.hits);\n    scrollAfterLoad();\n\n    const loadedImages = currentPage * perPage;\n\n    if (loadedImages >= totalHits) {\n      hideLoadMoreButton();\n\n      iziToast.info({\n        title: 'End',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    } else {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    console.error(error);\n    showLoadMoreButton();\n  } finally {\n    hideLoader();\n  }\n}\n\nfunction scrollAfterLoad() {\n  const galleryEl = getGalleryElement();\n  const firstCard = galleryEl.querySelector('.gallery__item');\n  if (!firstCard) return;\n\n  const { height } = firstCard.getBoundingClientRect();\n\n  window.scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n}"],"names":["BASE_URL","API_KEY","DEFAULT_PARAMS","getImagesByQuery","query","page","params","axios","error","galleryEl","loaderEl","lightbox","SimpleLightbox","loadMoreBtn","createGallery","images","markup","img","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","getGalleryElement","form","input","currentQuery","currentPage","totalHits","perPage","onSearch","onLoadMore","e","iziToast","data","scrollAfterLoad","firstCard","height"],"mappings":"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"}